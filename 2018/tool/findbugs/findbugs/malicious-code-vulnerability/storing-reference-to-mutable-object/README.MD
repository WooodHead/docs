# May expore internal representation by incorporating reference to mutable object

SVN:   

	CodeFarmerClub/baseplatform/workflow/trunk/wfpt4
	
判例:

	com.yixin.demo.core.ActExDemoTodoTaskEntity.java:109
	

代码：
      
    public void setReceiveTime(Date receiveTime) {
		this.receiveTime = receiveTime;
	}
         
描述：

    This code stores a reference to an externally mutable object into the internal representation of
	the object.  If instances are accessed by untrusted code, and unchecked changes to the mutable 
	object would compromise security or other important properties, you will need to do something 
	different. Storing a copy of the object is better approach in many situations.
	
建议：

	class MyClass {
		private Date billDate;
		public void setBillDate(Date billDate) {
			this.billDate = billDate;
		}
	}
	MyClass m = new MyClass();
	Date dateToBeSet = new Date();
	m.setBillDate(dateToBeSet); //The actual dateToBeSet is set to m
	dateToBeSet.setYear(...); 
	//^^^^^^^^ Un-intentional modification to dateToBeSet, will also modify the m's billDate
	To avoid this, you may want to Deep-copy before setting
	public void setBillDate(Date billDate) {
		this.billDate = new Date(billDate.getTime());
	}

参考：

[Date is mutable](http://stackoverflow.com/questions/18954873/malicious-code-vulnerability-may-expose-internal-representation-by-incorporati)